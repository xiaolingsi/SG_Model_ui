<!DOCTYPE html>
<html lang="en" style="height: 100%; width: 100%">
<head>
    <meta charset="UTF-8">
    <title>Welcome!</title>
</head>
<body style="height: 90%; width: 100% ;display: flex" >
    <div style="height: 100%; width: 60%;white-space: nowrap">
        <div id="container" style="height: 55%; width: 100%"></div>
        <div id="out_predict_container" style="height: 55%; width: 100%"></div>
    </div>
    <div style="height: 100%; width: 70%;white-space: nowrap;margin-left: 2%">
        <div id="cold_cpu_container" style="height: 55%; width: 100%"></div>
        <div id="info-container" style="width: 100%;
                                      height: 45%;
                                      border: 1px solid #ccc;
                                      overflow: hidden;
                                      overflow-y: scroll;">
            <!-- 滚动的信息将在这里显示 -->
          </div>
    </div>
    <div style="height: 100%; width: 60%;white-space: nowrap;margin-left: 1%">
        <div id="insideTemp_container" style="height: 55%; width: 100%"></div>
        <div id="insideTemp_predict" style="height: 55%; width: 100%"></div>
    </div>


  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <!-- Uncomment this line if you want to dataTool extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.3/dist/extension/dataTool.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use gl extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
  -->
  <!-- Uncomment this line if you want to echarts-stat extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-stat@latest/dist/ecStat.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use map
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/china.js"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/world.js"></script>
  -->
  <!-- Uncomment these two lines if you want to use bmap extension
  <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=YOUR_API_KEY"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.3/dist/extension/bmap.min.js"></script>
  -->
{#<script type="text/javascript" src="../static/api.js"></script>#}
  <script type="text/javascript">
    $.ajax({
        type:'GET',
        url:"http://127.0.0.1:8888/home/temperature",
        dataType:'json',
        async:false,
        success:function(data){
            temperature_data = data.valueOf('responseJSON').valueOf('temperature')
              //html原本的js代码
        }
    });
    var temperature_dom = document.getElementById('container');
    var myChart_temperature = echarts.init(temperature_dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    {#var app = {};#}

    var temperature_option;

    temperature_option = {
        tooltip: {
        trigger: 'axis'
    },
        title: [{
      left: 'center',
      text: 'Outside Temperature'
    }]
        ,
  xAxis: {
    type: 'category',
    data: temperature_data["time"].map(function (item) {
  return item.substr(9,8);
})
  },
  yAxis: {
    type: 'value',
      min: Math.round(Math.min.apply(null,temperature_data["temperature"]) - 2),
      max: Math.round(Math.max.apply(null,temperature_data["temperature"]) + 2)

  },
  series: [
    {
      data: temperature_data["temperature"],
      type: 'line',
      smooth: true,
        showSymbol: false,
    }
  ]
};

    if (temperature_option && typeof temperature_option === 'object') {
      myChart_temperature.setOption(temperature_option);
    }
    window.addEventListener('resize', myChart_temperature.resize);

    {# 以下为室外温度预测—————————————————————————————————————————————————————————————————————————— #}
    $.ajax({
        type:'GET',
        url:"http://127.0.0.1:8888/home/temperature_pre",
        dataType:'json',
        async:false,
        success:function(data){
            temperature_pre_data = data.valueOf('responseJSON').valueOf('temperature')
              //html原本的js代码
        }
    });
    var temperature_pre_dom = document.getElementById('out_predict_container');
    var myChart_temperature_pre = echarts.init(temperature_pre_dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    {#var app = {};#}

    var temperature_pre_option;

    temperature_pre_option = {
         legend:{
    data:['预测值','历史值'],
    orient: 'horizontal', // 图例的布局方向（垂直）
    right: 0, // 图例距离右侧的距离
    top: 'center', // 图例垂直居中
        },
        tooltip: {
        trigger: 'axis'
    },
        title: [{
      left: 'center',
      text: 'Outside Temperature Predict'
    }]
        ,
  xAxis: {
    type: 'category',
    data: temperature_pre_data["time"].map(function (item) {
  return item.substr(17,8);
})
  },
  yAxis: {
    type: 'value',
      min: Math.round(Math.min.apply(null,temperature_pre_data["temperature"]) - 2),
      max: Math.round(Math.max.apply(null,temperature_pre_data["temperature"]) + 2)

  },
  series: [

      {
      data: temperature_pre_data["temperature"],
      type: 'line',
      smooth: true,
        showSymbol: false,
          name:'预测值',
          color:'#e67e22',
    },
    {
      data: temperature_pre_data["temperature"].slice(1,240),
      type: 'line',
      smooth: true,
        showSymbol: false,
        name:'历史值',
        color:'#3498db',
        lineWidth: 20,
        lineStyle:{
        width:3//设置线条粗细
                                }
    }
  ]
};

    if (temperature_pre_option && typeof temperature_pre_option === 'object') {
      myChart_temperature_pre.setOption(temperature_pre_option);
    }
    window.addEventListener('resize', myChart_temperature_pre.resize);

    {# 以下为回水温度展示—————————————————————————————————————————————————————————————————————————— #}
    $.ajax({
        type:'GET',
        url:"http://127.0.0.1:8888/home/cold_cpu",
        dataType:'json',
        async:false,
        success:function(data){
            temperature_data = data.valueOf('responseJSON').valueOf('temperature')
              //html原本的js代码
        }
    });
    {#console.log(temperature_data)#}
    {#console.log(temperature_data["temperature"]['out_temperature_2'])#}
    var cold_cpu_dom = document.getElementById('cold_cpu_container');
    var myChart_cold_cpu = echarts.init(cold_cpu_dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    var cold_cpu_option;
    cold_cpu_option = {
        legend:{
    data:['妇产楼','儿童楼','门诊楼单台','门诊楼1','门诊楼2'],
    orient: 'vertical', // 图例的布局方向（垂直）
    right: 0, // 图例距离右侧的距离
    top: 'center', // 图例垂直居中

        },
        grid: {
    right: '20%' // 图表右边距离
  },
        tooltip: {
        trigger: 'axis'
    },
        title: [{
      left: 'center',
      text: '冷水主机回水温度'
    }]
        ,
  xAxis: {
    type: 'category',
    data: temperature_data["time"].map(function (item) {
  return item.substr(17,8);
})
  },
  yAxis: {
    type: 'value',
  },
  series: [
    {
      data: temperature_data["temperature"]["out_temperature_1"],
      type: 'line',
        color:'#9b59b6',
      smooth: true,
        name:'妇产楼'
    },
      {
      data: temperature_data["temperature"]["out_temperature_2"],
      type: 'line',
        color:'#3498db',
      smooth: true,

        name:'儿童楼'
    },
      {
      data: temperature_data["temperature"]["out_temperature_3"],
      type: 'line',
        color:'#2ecc71',
      smooth: true,
          name:'门诊楼单台'
    },
      {
      data: temperature_data["temperature"]["out_temperature_4"],
      type: 'line',
        color:'#e74c3c',
      smooth: true,
          name:'门诊楼1'
    },
      {
      data: temperature_data["temperature"]["out_temperature_5"],
      type: 'line',
        color:'#e67e22',
      smooth: true,
          name:'门诊楼2'
    }
  ]
};

    if (cold_cpu_option && typeof cold_cpu_option === 'object') {
      myChart_cold_cpu.setOption(cold_cpu_option);
    }
    window.addEventListener('resize', myChart_cold_cpu.resize);



  {#  以下为室内温度展示 ————————————————————————————————————————————————————————————————————————————————#}
    $.ajax({
        type:'GET',
        url:"http://127.0.0.1:8888/home/inside_temp",
        dataType:'json',
        async:false,
        success:function(data){
            temperature_data = data.valueOf('responseJSON').valueOf('temperature')
              //html原本的js代码
        }
    });
    var inside_temp_dom = document.getElementById('insideTemp_container');
    var myChart_inside_temp = echarts.init(inside_temp_dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    {#var app = {};#}

    var inside_temp_option;

const inside_temp_dateList = temperature_data["time"].map(function (item) {
  return item.substr(17,8);
});
const inside_temp_valueList = temperature_data["temperature"]
inside_temp_option = {
  // Make gradient line here
  visualMap: [
    {
      show: false,
      type: 'continuous',
      seriesIndex: 0,
    }
  ],
  title: [
    {
      left: 'center',
      text: 'Inside Temperature'
    }
  ],
  tooltip: {
    trigger: 'axis'
  },
  xAxis: [
    {
      data: inside_temp_dateList,
    }

  ],

  yAxis: [
    {
        min: Math.round(Math.min.apply(null,inside_temp_valueList) - 2),
        max: Math.round(Math.max.apply(null,inside_temp_valueList) + 2)
    }
  ],

  series: [
    {
      type: 'line',
      showSymbol: false,
      data: inside_temp_valueList,

    }
  ]
};

    if (inside_temp_option && typeof inside_temp_option === 'object') {
      myChart_inside_temp.setOption(inside_temp_option);
    }

    window.addEventListener('resize', myChart_inside_temp.resize);
{#  以下为室内温度预测————————————————————————————————————————————————————————————————————————————————#}
     $.ajax({
        type:'GET',
        url:"http://127.0.0.1:8888/home/insidetemp_pre",
        dataType:'json',
        async:false,
        success:function(data){
            temperature_data_pre = data.valueOf('responseJSON').valueOf('temperature')
              //html原本的js代码
        }
    });
    var inside_temp_pre_dom = document.getElementById('insideTemp_predict');
    var myChart_inside_temp_pre = echarts.init(inside_temp_pre_dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    {#var app = {};#}

    var inside_temp_pre_option;

const inside_temp_pre_dateList = temperature_data_pre["time"].map(function (item) {
  return item.substr(17,8);
});
const inside_temp_pre_valueList = temperature_data_pre["temperature"]
inside_temp_pre_option = {
  // Make gradient line here
  visualMap: [
    {
      show: false,
      type: 'continuous',
      seriesIndex: 0,
    }
  ],
  title: [
    {
      left: 'center',
      text: 'Inside Temperature Predict'
    }
  ],
  tooltip: {
    trigger: 'axis'
  },
  xAxis: [
    {
      data: inside_temp_pre_dateList,
    }

  ],

  yAxis: [
    {
        min: Math.round(Math.min.apply(null,inside_temp_pre_valueList) - 2),
        max: Math.round(Math.max.apply(null,inside_temp_pre_valueList) + 2)
    }
  ],

  series: [

      {
      data: inside_temp_pre_valueList,
      type: 'line',
      smooth: true,
        showSymbol: false,
          name:'预测值',
          color:'#e67e22',
    },
    {
      data: inside_temp_pre_valueList.slice(1,250),
      type: 'line',
      smooth: true,
        showSymbol: false,
        name:'历史值',
        color:'#3498db',
        lineWidth: 20,
        lineStyle:{
        width:3//设置线条粗细
                                }
    }
  ]
};

    if (inside_temp_pre_option && typeof inside_temp_pre_option === 'object') {
      myChart_inside_temp_pre.setOption(inside_temp_pre_option);
    }

    window.addEventListener('resize', myChart_inside_temp_pre.resize);
    $.ajax({
        type:'GET',
        url:"http://127.0.0.1:8888/home/info",
        dataType:'json',
        async:false,
        success:function(data){
            mqtt_info = data
              //html原本的js代码
        }
    });
    const infoContainer = document.getElementById("info-container");
    console.log(mqtt_info)
    for (let i = 0;i<3;i++){
        const message = document.createElement("div");
        message.textContent = mqtt_info[i];
        infoContainer.appendChild(message);
    }


  // 滚动到最新消息位置
  infoContainer.scrollTop = infoContainer.scrollHeight;
  </script>
</body>
</html>